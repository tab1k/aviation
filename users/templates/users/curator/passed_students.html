<!-- templates/users/admin/admin_passed_students.html -->

{% extends 'users/curator/base.html' %}
{% load static %}

<head>
  <meta charset="utf-8">
  <title></title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Lexend&display=swap">
  {% block css %}
      <link rel="stylesheet" type="text/css" href="{% static 'admin/css/student.css' %}" rel="stylesheet">
      <link rel="stylesheet" type="text/css" href="{% static 'admin/css/passed_students.css' %}" rel="stylesheet">
      <link rel="stylesheet" type="text/css" href="{% static 'admin/css/responsive_passed_student.css' %}">
  {% endblock %}
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />
  <link href="https://fonts.googleapis.com/css2?family=Rubik&display=swap" rel="stylesheet">
</head>

<div class="all_page">
  {% block content %}
  <div class="content">

    <div class="content-header">

        <h2>Список успешно завершивших студентов</h2>
        <form action="{% url 'users:admin:courses:passed_students' %}" method="get">

          <div class="search-footer">
            <input name="q" placeholder="Поиск...">
            <button>Поиск</button>
          </div>

        </form>
    </div>
    <div>
        <form action="{% url 'users:admin:courses:passed_students' %}" method="get">
            <div style="display: flex; align-items: center; margin-top: 10px;">
                <select name="course_filter" id="course_filter" style="padding: 5px; border: 1px solid #ccc; border-radius: 4px;">
                    <option value="">Все курсы</option>
                    {% for course in all_courses %}
                        <option value="{{ course.id }}" {% if selected_course_id == course.id %}selected{% endif %}>{{ course.title }}</option>
                    {% endfor %}
                </select>
                <button style="padding: 5px 10px; background-color: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; transition: background-color 0.3s ease; margin-left: 10px; align-self: flex-start;">
                    Применить
                </button>
            </div>
        </form>
    </div>

    {% if passed_students %}
    <div class="responsive-table">
      <table class="student-table">
        <thead style="display: contents">
          <tr>
            <th>Имя</th>
            <th>Фамилия</th>
            <th>Email</th>
            <th>Курс</th>
            <th>Посмотреть успеваемость</th>
            <th>Выдать</th>
          </tr>
        </thead>
        <tbody>
          {% for student in passed_students %}
          <tr>
            <td>{{ student.first_name }}</td>
            <td>{{ student.last_name }}</td>
            <td>{{ student.email }}</td>
            <td>
                {% for course in student.courses.all %}
                      - {{ course.title }}<br>{% if not forloop.last %} {% endif %}
                {% endfor %}
            </td>
            <td><a href="{% url 'users:admin:courses:student_progress' student_id=student.id %}">Успеваемость</a></td>
            <td><a href="{% url 'users:admin:courses:generate_certificate' student_id=student.id %}" target="_blank">Выдать сертификат</a></td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    {% else %}
    <p>Пока нет успешно завершивших студентов.</p>
    {% endif %}
  </div>
  {% endblock %}
</div>